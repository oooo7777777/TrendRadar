
    <!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>热点新闻分析</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js" integrity="sha512-BNaRQnYJYiPSqHHDb58B0yaPfCu+Wgds8Gp/gU33kqBtgNS4tSPHuGibyoeqMV/TJlSKda6FXzoEyYGjTe+vXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <style>
            * { box-sizing: border-box; }
            body { 
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
                margin: 0; 
                padding: 16px; 
                background: #fafafa;
                color: #333;
                line-height: 1.5;
            }
            
            .container {
                max-width: 600px;
                margin: 0 auto;
                background: white;
                border-radius: 12px;
                overflow: hidden;
                box-shadow: 0 2px 16px rgba(0,0,0,0.06);
            }
            
            .header {
                background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
                color: white;
                padding: 32px 24px;
                text-align: center;
                position: relative;
            }
            
            .save-buttons {
                position: absolute;
                top: 16px;
                right: 16px;
                display: flex;
                gap: 8px;
            }
            
            .save-btn {
                background: rgba(255, 255, 255, 0.2);
                border: 1px solid rgba(255, 255, 255, 0.3);
                color: white;
                padding: 8px 16px;
                border-radius: 6px;
                cursor: pointer;
                font-size: 13px;
                font-weight: 500;
                transition: all 0.2s ease;
                backdrop-filter: blur(10px);
                white-space: nowrap;
            }
            
            .save-btn:hover {
                background: rgba(255, 255, 255, 0.3);
                border-color: rgba(255, 255, 255, 0.5);
                transform: translateY(-1px);
            }
            
            .save-btn:active {
                transform: translateY(0);
            }
            
            .save-btn:disabled {
                opacity: 0.6;
                cursor: not-allowed;
            }
            
            .header-title {
                font-size: 22px;
                font-weight: 700;
                margin: 0 0 20px 0;
            }
            
            .header-info {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 16px;
                font-size: 14px;
                opacity: 0.95;
            }
            
            .info-item {
                text-align: center;
            }
            
            .info-label {
                display: block;
                font-size: 12px;
                opacity: 0.8;
                margin-bottom: 4px;
            }
            
            .info-value {
                font-weight: 600;
                font-size: 16px;
            }
            
            .content {
                padding: 24px;
            }
            
            .word-group {
                margin-bottom: 40px;
            }
            
            .word-group:first-child {
                margin-top: 0;
            }
            
            .word-header {
                display: flex;
                align-items: center;
                justify-content: space-between;
                margin-bottom: 20px;
                padding-bottom: 8px;
                border-bottom: 1px solid #f0f0f0;
            }
            
            .word-info {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            
            .word-name {
                font-size: 17px;
                font-weight: 600;
                color: #1a1a1a;
            }
            
            .word-count {
                color: #666;
                font-size: 13px;
                font-weight: 500;
            }
            
            .word-count.hot { color: #dc2626; font-weight: 600; }
            .word-count.warm { color: #ea580c; font-weight: 600; }
            
            .word-index {
                color: #999;
                font-size: 12px;
            }
            
            .news-item {
                margin-bottom: 20px;
                padding: 16px 0;
                border-bottom: 1px solid #f5f5f5;
                position: relative;
                display: flex;
                gap: 12px;
                align-items: center;
            }
            
            .news-item:last-child {
                border-bottom: none;
            }
            
            .news-item.new::after {
                content: "NEW";
                position: absolute;
                top: 12px;
                right: 0;
                background: #fbbf24;
                color: #92400e;
                font-size: 9px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 4px;
                letter-spacing: 0.5px;
            }
            
            .news-number {
                color: #999;
                font-size: 13px;
                font-weight: 600;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
                align-self: flex-start;
                margin-top: 8px;
            }
            
            .news-content {
                flex: 1;
                min-width: 0;
                padding-right: 40px;
            }
            
            .news-item.new .news-content {
                padding-right: 50px;
            }
            
            .news-header {
                display: flex;
                align-items: center;
                gap: 8px;
                margin-bottom: 8px;
                flex-wrap: wrap;
            }
            
            .source-name {
                color: #666;
                font-size: 12px;
                font-weight: 500;
            }
            
            .rank-num {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 2px 6px;
                border-radius: 10px;
                min-width: 18px;
                text-align: center;
            }
            
            .rank-num.top { background: #dc2626; }
            .rank-num.high { background: #ea580c; }
            
            .time-info {
                color: #999;
                font-size: 11px;
            }
            
            .count-info {
                color: #059669;
                font-size: 11px;
                font-weight: 500;
            }
            
            .news-title {
                font-size: 15px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .news-link {
                color: #2563eb;
                text-decoration: none;
            }
            
            .news-link:hover {
                text-decoration: underline;
            }
            
            .news-link:visited {
                color: #7c3aed;
            }
            
            .new-section {
                margin-top: 40px;
                padding-top: 24px;
                border-top: 2px solid #f0f0f0;
            }
            
            .new-section-title {
                color: #1a1a1a;
                font-size: 16px;
                font-weight: 600;
                margin: 0 0 20px 0;
            }
            
            .new-source-group {
                margin-bottom: 24px;
            }
            
            .new-source-title {
                color: #666;
                font-size: 13px;
                font-weight: 500;
                margin: 0 0 12px 0;
                padding-bottom: 6px;
                border-bottom: 1px solid #f5f5f5;
            }
            
            .new-item {
                display: flex;
                align-items: center;
                gap: 12px;
                padding: 8px 0;
                border-bottom: 1px solid #f9f9f9;
            }
            
            .new-item:last-child {
                border-bottom: none;
            }
            
            .new-item-number {
                color: #999;
                font-size: 12px;
                font-weight: 600;
                min-width: 18px;
                text-align: center;
                flex-shrink: 0;
                background: #f8f9fa;
                border-radius: 50%;
                width: 20px;
                height: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .new-item-rank {
                color: #fff;
                background: #6b7280;
                font-size: 10px;
                font-weight: 700;
                padding: 3px 6px;
                border-radius: 8px;
                min-width: 20px;
                text-align: center;
                flex-shrink: 0;
            }
            
            .new-item-rank.top { background: #dc2626; }
            .new-item-rank.high { background: #ea580c; }
            
            .new-item-content {
                flex: 1;
                min-width: 0;
            }
            
            .new-item-title {
                font-size: 14px;
                line-height: 1.4;
                color: #1a1a1a;
                margin: 0;
            }
            
            .error-section {
                background: #fef2f2;
                border: 1px solid #fecaca;
                border-radius: 8px;
                padding: 16px;
                margin-bottom: 24px;
            }
            
            .error-title {
                color: #dc2626;
                font-size: 14px;
                font-weight: 600;
                margin: 0 0 8px 0;
            }
            
            .error-list {
                list-style: none;
                padding: 0;
                margin: 0;
            }
            
            .error-item {
                color: #991b1b;
                font-size: 13px;
                padding: 2px 0;
                font-family: 'SF Mono', Consolas, monospace;
            }
            
            .footer {
                margin-top: 32px;
                padding: 20px 24px;
                background: #f8f9fa;
                border-top: 1px solid #e5e7eb;
                text-align: center;
            }
            
            .footer-content {
                font-size: 13px;
                color: #6b7280;
                line-height: 1.6;
            }
            
            .footer-link {
                color: #4f46e5;
                text-decoration: none;
                font-weight: 500;
                transition: color 0.2s ease;
            }
            
            .footer-link:hover {
                color: #7c3aed;
                text-decoration: underline;
            }
            
            .project-name {
                font-weight: 600;
                color: #374151;
            }
            
            @media (max-width: 480px) {
                body { padding: 12px; }
                .header { padding: 24px 20px; }
                .content { padding: 20px; }
                .footer { padding: 16px 20px; }
                .header-info { grid-template-columns: 1fr; gap: 12px; }
                .news-header { gap: 6px; }
                .news-content { padding-right: 45px; }
                .news-item { gap: 8px; }
                .new-item { gap: 8px; }
                .news-number { width: 20px; height: 20px; font-size: 12px; }
                .save-buttons {
                    position: static;
                    margin-bottom: 16px;
                    display: flex;
                    gap: 8px;
                    justify-content: center;
                    flex-direction: column;
                    width: 100%;
                }
                .save-btn {
                    width: 100%;
                }
            }
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <div class="save-buttons">
                    <button class="save-btn" onclick="saveAsImage()">保存为图片</button>
                    <button class="save-btn" onclick="saveAsMultipleImages()">分段保存</button>
                </div>
                <div class="header-title">热点新闻分析</div>
                <div class="header-info">
                    <div class="info-item">
                        <span class="info-label">报告类型</span>
                        <span class="info-value">当日汇总</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">新闻总数</span>
                        <span class="info-value">745 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">热点新闻</span>
                        <span class="info-value">49 条</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">生成时间</span>
                        <span class="info-value">10-30 15:18</span>
                    </div>
                </div>
            </div>
            
            <div class="content">
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">AI 人工智能 算法 模型 数据 机器学习 深度学习 神经网络 智能系统 自动化 智能助手 生成式AI 算法优化 智能感知 自然语言处理（NLP） 计算机视觉 语音识别 图像识别 强化学习 迁移学习 联邦学习 大模型 科技创新 云计算 芯片 智能硬件 自动驾驶 可穿戴设备 量子计算 区块链 元宇宙 XR 5G AI芯片 智能手机 科技生态 开源社区</div>
                            <div class="word-count hot">15 条</div>
                        </div>
                        <div class="word-index">1/5</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num top">1</span><span class="time-info">00时25分~07时17分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2185058" target="_blank" class="news-link">510亿！央企战新基金来了 重点支持人工智能、航空航天等未来产业</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num top">2-4</span><span class="time-info">00时25分~07时17分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2184916" target="_blank" class="news-link">【数据看盘】机构、量化豪掷近12亿抢筹阳光电源 IM期指空头大幅减仓</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num high">5-11</span><span class="time-info">00时25分~09时26分</span><span class="count-info">9次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=%E5%A4%96%E4%BA%A4%E9%83%A8%E5%9B%9E%E5%BA%94%E9%BB%84%E4%BB%81%E5%8B%8BAI%E8%8A%AF%E7%89%87%E8%A8%80%E8%AE%BA" target="_blank" class="news-link">外交部回应黄仁勋AI芯片言论</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">7-18</span><span class="time-info">00时25分~15时18分</span><span class="count-info">14次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31533770" target="_blank" class="news-link">那些“染上网瘾”的老年人，要怎么和AI相处？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num ">12</span><span class="time-info">00时25分~07时17分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2287291" target="_blank" class="news-link">网民用AI编造散播谣言被处罚</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">15-16</span><span class="time-info">00时25分~07时17分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7566339492316024361/" target="_blank" class="news-link">中方回应黄仁勋称美AI芯片需出口中国</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">9-13</span><span class="time-info">09时26分~15时18分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2185569" target="_blank" class="news-link">OpenAI据悉计划最早明年下半年提交上市申请 | 环球市场</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">7-10</span><span class="time-info">09时26分~13时18分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2185393" target="_blank" class="news-link">AI伴侣引发争议！Character.AI将禁止未成年人与其聊天机器人对话</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">7-10</span><span class="time-info">12时21分~15时18分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2185750" target="_blank" class="news-link">AI引爆存储芯片需求！三星Q3营业利润环比猛增160% 股价再创新高</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">抖音</span><span class="rank-num ">19</span><span class="time-info">09时26分~13时18分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.douyin.com/hot/2288033" target="_blank" class="news-link">OpenAI计划于2027年上市</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">10</span><span class="time-info">00时25分~01时17分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3758110" target="_blank" class="news-link">基金三季报重仓榜揭晓：这是茅台的“黄昏”，更是AI硬科技的“黎明”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">11-16</span><span class="time-info">13时18分~14时28分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1966652250177893275" target="_blank" class="news-link">OpenAI 宣布完成资本重组，如何看待这个精心设计的「新架构」？能否真正确立其非营利的使命？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">12</span><span class="time-info">13时18分~14时28分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1963343251323969618" target="_blank" class="news-link">研究称对 AI 粗鲁提问准确率更高，真的是这样吗？为什么会出现这种现象？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">14</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">19</span><span class="time-info">00时25分~01时17分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1961557481399486011" target="_blank" class="news-link">智能手机的影像越来越强了，随手一拍也挺好看，出游还有必要带相机吗？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">15</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">30</span><span class="time-info">07时17分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7566571800620961286/" target="_blank" class="news-link">黄仁勋感叹“中国芯片爆发”</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">国外科技资讯 苹果公司 iphone mac 谷歌 微软 亚马逊 Meta Facebook 特斯拉 英伟达 英特尔 AMD OpenAI Anthropic IBM 三星 索尼 华为 比亚迪 字节跳动 推特</div>
                            <div class="word-count hot">13 条</div>
                        </div>
                        <div class="word-index">2/5</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num top">3-5</span><span class="time-info">00时25分~07时17分</span><span class="count-info">8次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3758056" target="_blank" class="news-link">科技巨头力撑美三大指数再创新高，但多数股票下跌，英伟达破新高，黄金三连跌</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num top">1</span><span class="time-info">00时25分~05时17分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3758111" target="_blank" class="news-link">一文看清英伟达GTC黄仁勋演讲要点：2000万块Blackwell销售预期，Rubin首秀，推出NVQLink，6G等重磅合作</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num top">1-7</span><span class="time-info">07时17分~15时18分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3758166" target="_blank" class="news-link">鲍威尔意外鹰派，美股盘中转跌，英伟达支撑纳指最终收涨，美债黄金比特币跌，美元拉升</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num high">4-6</span><span class="time-info">07时17分~15时18分</span><span class="count-info">7次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2185493" target="_blank" class="news-link">美股收盘：标普道指回落、纳指独领风骚 英伟达市值站稳5万亿</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">7-10</span><span class="time-info">00时25分~09时26分</span><span class="count-info">9次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2185261" target="_blank" class="news-link">英伟达市值冲击5万亿美元 美联储决议重磅来袭 | 今夜看点</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num top">1-14</span><span class="time-info">07时17分~11时10分</span><span class="count-info">3次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1966812988695634721" target="_blank" class="news-link">如何看待英伟达 10 亿美元入股诺基亚？频繁大额投资背后，英伟达在布什么局？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">7-8</span><span class="time-info">11时10分~15时18分</span><span class="count-info">5次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3758231" target="_blank" class="news-link">Meta一次性税费致季度盈利暴跌83%，预计明年资本支出大增，盘后重挫超8%｜财报见闻</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">7-10</span><span class="time-info">02时28分~06时18分</span><span class="count-info">5次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3758166" target="_blank" class="news-link">利率决议、业绩报告在即，美股指数集体上涨，英伟达总市值突破5万亿美元，黄金突破4000美元关口</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">6-7</span><span class="time-info">12时21分~15时18分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1966514830467892473" target="_blank" class="news-link">华为余承东称「车速跑到 120km/h，风阻消耗的能量可占总能耗 70% 以上」，有这么夸张吗？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num top">3-11</span><span class="time-info">09时26分~11时10分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1966813234586678079" target="_blank" class="news-link">若万亿美元薪酬被拒，马斯克可能离开特斯拉，马斯克不缺钱，为什么一定要万亿美元薪酬？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">凤凰网</span><span class="rank-num ">9</span><span class="time-info">12时21分~15时18分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://news.ifeng.com/c/8nr6MpZgMMM" target="_blank" class="news-link">史上首家！英伟达市值破5万亿美元</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">12</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">财联社热门</span><span class="rank-num ">11-12</span><span class="time-info">09时26分~11时10分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.cls.cn/detail/2185503" target="_blank" class="news-link">Meta财报让投资人眼前一黑：“大而美”法案带来天价税费 明年还将加速“烧钱”</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">13</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">7</span><span class="time-info">09时26分</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1966988124639953699" target="_blank" class="news-link">英伟达市值站上 5 万亿美元，为史上首家，背后核心驱动力是什么？对全球科技产业的有哪些影响？</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">运动 体育赛事 比赛 冠军 世界杯 欧洲杯 亚洲杯</div>
                            <div class="word-count hot">11 条</div>
                        </div>
                        <div class="word-index">3/5</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">贴吧</span><span class="rank-num top">2-14</span><span class="time-info">00时25分~15时18分</span><span class="count-info">14次</span>
                            </div>
                            <div class="news-title"><a href="https://tieba.baidu.com/hottopic/browse/hottopic?topic_id=28346416&amp;amp;topic_name=%E6%AF%94%E8%B5%9B%E5%BF%AB%E8%BF%87%E5%90%83%E5%A4%96%E5%8D%96%2CKT%E7%A2%BE%E5%8E%8B%E4%B9%8B%E5%8A%BF%E6%99%8B%E7%BA%A7" target="_blank" class="news-link">比赛快过吃外卖,KT碾压之势晋级</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num ">15-28</span><span class="time-info">00时25分~14时28分</span><span class="count-info">13次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=EDG%E8%8B%B1%E9%9B%84%E8%81%94%E7%9B%9F%E5%86%A0%E5%86%9B%E7%BB%8F%E7%90%86%E5%8A%A0%E5%85%A5%E7%93%A6%E5%88%86%E9%83%A8" target="_blank" class="news-link">EDG英雄联盟冠军经理加入瓦分部</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">贴吧</span><span class="rank-num ">17-29</span><span class="time-info">00时25分~14时28分</span><span class="count-info">13次</span>
                            </div>
                            <div class="news-title"><a href="https://tieba.baidu.com/hottopic/browse/hottopic?topic_id=28346429&amp;amp;topic_name=%E7%A1%AC%E6%9B%BF%E5%9B%A2%E5%A4%84%2CEDG%E7%81%AB%E9%80%9F%E6%8B%BD%E5%9B%9E%E5%86%A0%E5%86%9B%E7%BB%8F%E7%90%86" target="_blank" class="news-link">硬替团处,EDG火速拽回冠军经理</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">9-30</span><span class="time-info">00时25分~07时17分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://m.weibo.cn/search?containerid=100103type%3D1%26t%3D10%26q%3D%E7%8E%8B%E6%9B%BC%E6%98%B1%E7%88%B6%E6%AF%8D%E7%94%A8%E7%88%B1%E6%89%98%E4%B8%BE%E7%9A%84%E5%A5%A5%E8%BF%90%E5%86%A0%E5%86%9B&amp;stream_entry_id=31&amp;isnewpage=1&amp;extparam=seat%3D1%26realpos%3D9%26lcate%3D5001%26stream_entry_id%3D31%26q%3D%25E7%258E%258B%25E6%259B%25BC%25E6%2598%25B1%25E7%2588%25B6%25E6%25AF%258D%25E7%2594%25A8%25E7%2588%25B1%25E6%2589%2598%25E4%25B8%25BE%25E7%259A%2584%25E5%25A5%25A5%25E8%25BF%2590%25E5%2586%25A0%25E5%2586%259B%26dgr%3D0%26band_rank%3D9%26filter_type%3Drealtimehot%26pos%3D9%26flag%3D1%26cate%3D5001%26c_type%3D31%26display_time%3D1761754276%26pre_seqid%3D176175427682101169740156" target="_blank" class="news-link">王曼昱父母用爱托举的奥运冠军</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num high">5-7</span><span class="time-info">00时25分~03时14分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1966865993381950895" target="_blank" class="news-link">S15 淘汰赛 KT 3:0 淘汰 CFO 队史首次晋级全球总决赛四强赛，如何评价这场比赛？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num top">3-12</span><span class="time-info">00时25分~01时17分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1966849513793777750" target="_blank" class="news-link">韩国乒乓球奥运冠军柳承敏因涉嫌以他人名义套取奖励金，被警方调查，如何看待此事？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">8-9</span><span class="time-info">12时21分~15时18分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31852575" target="_blank" class="news-link">目前出场的4名乒乓国手，全都蒙彼利埃冠军赛一轮游</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">bilibili 热搜</span><span class="rank-num ">26-30</span><span class="time-info">00时25分~05时17分</span><span class="count-info">4次</span>
                            </div>
                            <div class="news-title"><a href="https://search.bilibili.com/all?keyword=Hope%E8%AF%B4%E6%83%B3%E8%B5%A2%E4%B8%8B%E6%9B%B4%E5%A4%9A%E6%AF%94%E8%B5%9B" target="_blank" class="news-link">Hope说想赢下更多比赛</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">9-11</span><span class="time-info">14时28分~15时18分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1967157595967035015" target="_blank" class="news-link">2526 赛季 NBA 常规赛开拓者 136:134 爵士，杨瀚森得到 2 分，如何评价这场比赛？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">10</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num ">16-17</span><span class="time-info">14时28分~15时18分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1967165163049312837" target="_blank" class="news-link">2526 赛季 NBA 常规赛湖人 116:115 森林狼，如何评价这场比赛？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">11</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">24</span><span class="time-info">00时25分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7566214977406877702/" target="_blank" class="news-link">世界冠军奥运冠军为全运会打CALL</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">国内科技资讯 华为 小米 OPPO vivo 百度 阿里巴巴 腾讯 字节跳动 美团 京东 拼多多 科大讯飞 商汤科技 旷视科技 依图科技 寒武纪</div>
                            <div class="word-count warm">9 条</div>
                        </div>
                        <div class="word-index">4/5</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">知乎</span><span class="rank-num top">2-5</span><span class="time-info">09时26分~15时18分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://www.zhihu.com/question/1966442318644081320" target="_blank" class="news-link">美团骑手社保补贴正式覆盖全国，预计美团将每年多支出多少人力成本？</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">2</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">贴吧</span><span class="rank-num ">14-29</span><span class="time-info">00时25分~15时18分</span><span class="count-info">14次</span>
                            </div>
                            <div class="news-title"><a href="https://tieba.baidu.com/hottopic/browse/hottopic?topic_id=28346392&amp;amp;topic_name=%E5%B0%8F%E7%B1%B3%E7%8B%82%E6%8F%BD%E8%BD%A6%E6%A6%9C%E7%AC%AC%E4%B8%80%2C%E8%B4%A8%E7%96%91%E9%93%BA%E5%A4%A9%E7%9B%96%E5%9C%B0" target="_blank" class="news-link">小米狂揽车榜第一,质疑铺天盖地</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">3</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">贴吧</span><span class="rank-num ">18-30</span><span class="time-info">00时25分~14时28分</span><span class="count-info">13次</span>
                            </div>
                            <div class="news-title"><a href="https://tieba.baidu.com/hottopic/browse/hottopic?topic_id=28346411&amp;amp;topic_name=%E5%8A%A0%E5%85%A5%E7%BE%8E%E5%9B%A2%E6%90%9E%E9%97%AA%E9%80%81%3Fshy%E5%9C%88%E7%B1%B3%E6%9C%89%E4%B8%80%E6%89%8B" target="_blank" class="news-link">加入美团搞闪送?shy圈米有一手</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">4</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num high">5-28</span><span class="time-info">00时25分~09时26分</span><span class="count-info">9次</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7565540045223264262/" target="_blank" class="news-link">小米高管回应“巨省电”是产品名</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">5</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">6-10</span><span class="time-info">00时25分~09时26分</span><span class="count-info">9次</span>
                            </div>
                            <div class="news-title"><a href="https://m.weibo.cn/search?containerid=100103type%3D1%26t%3D10%26q%3D%23%E5%B0%8F%E7%B1%B3%E9%AB%98%E7%AE%A1%E5%9B%9E%E5%BA%94%E5%B7%A8%E7%9C%81%E7%94%B5%E6%98%AF%E7%A9%BA%E8%B0%83%E5%90%8D%23&amp;stream_entry_id=31&amp;isnewpage=1&amp;extparam=seat%3D1%26realpos%3D7%26lcate%3D5001%26stream_entry_id%3D31%26q%3D%2523%25E5%25B0%258F%25E7%25B1%25B3%25E9%25AB%2598%25E7%25AE%25A1%25E5%259B%259E%25E5%25BA%2594%25E5%25B7%25A8%25E7%259C%2581%25E7%2594%25B5%25E6%2598%25AF%25E7%25A9%25BA%25E8%25B0%2583%25E5%2590%258D%2523%26dgr%3D0%26band_rank%3D7%26filter_type%3Drealtimehot%26pos%3D7%26flag%3D0%26cate%3D5001%26c_type%3D31%26display_time%3D1761754276%26pre_seqid%3D176175427682101169740156" target="_blank" class="news-link">小米高管回应巨省电是空调名</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">6</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">澎湃新闻</span><span class="rank-num ">10-11</span><span class="time-info">09时26分~15时18分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://m.thepaper.cn/newsDetail_forward_31852446" target="_blank" class="news-link">双十一期间“二选一”？直播间价格竞争？京东、抖音、美的三方回应</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">7</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">14</span><span class="time-info">14时28分~15时18分</span><span class="count-info">2次</span>
                            </div>
                            <div class="news-title"><a href="https://m.weibo.cn/search?containerid=100103type%3D1%26t%3D10%26q%3D%23%E8%96%9B%E4%B9%8B%E8%B0%A6%E6%BD%98%E7%8E%AE%E6%9F%8F%E5%8A%A0%E7%9B%9F%E4%BA%AC%E4%B8%9C1111%E6%83%8A%E5%96%9C%E4%B9%8B%E5%A4%9C%23&amp;stream_entry_id=31&amp;isnewpage=1&amp;extparam=seat%3D1%26flag%3D1%26lcate%3D5001%26q%3D%2523%25E8%2596%259B%25E4%25B9%258B%25E8%25B0%25A6%25E6%25BD%2598%25E7%258E%25AE%25E6%259F%258F%25E5%258A%25A0%25E7%259B%259F%25E4%25BA%25AC%25E4%25B8%259C1111%25E6%2583%258A%25E5%2596%259C%25E4%25B9%258B%25E5%25A4%259C%2523%26stream_entry_id%3D31%26filter_type%3Drealtimehot%26band_rank%3D14%26c_type%3D31%26pos%3D15%26realpos%3D14%26cate%3D5001%26dgr%3D0%26display_time%3D1761805550%26pre_seqid%3D176180555005801131712146" target="_blank" class="news-link">薛之谦潘玮柏加盟京东1111惊喜之夜</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">8</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">微博</span><span class="rank-num ">14</span><span class="time-info">11时10分</span>
                            </div>
                            <div class="news-title"><a href="https://m.weibo.cn/search?containerid=100103type%3D1%26t%3D10%26q%3D%23%E4%BA%AC%E4%B8%9C%E6%9A%96%E5%BF%83%E7%95%99%E8%A8%80%23&amp;stream_entry_id=31&amp;isnewpage=1&amp;extparam=seat%3D1%26filter_type%3Drealtimehot%26c_type%3D31%26band_rank%3D14%26cate%3D5001%26pos%3D15%26stream_entry_id%3D31%26flag%3D1%26q%3D%2523%25E4%25BA%25AC%25E4%25B8%259C%25E6%259A%2596%25E5%25BF%2583%25E7%2595%2599%25E8%25A8%2580%2523%26lcate%3D5001%26dgr%3D0%26realpos%3D14%26display_time%3D1761792759%26pre_seqid%3D17617927592080363020174" target="_blank" class="news-link">京东暖心留言</a>
                            </div>
                        </div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">9</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">今日头条</span><span class="rank-num ">26</span><span class="time-info">01时17分</span>
                            </div>
                            <div class="news-title"><a href="https://www.toutiao.com/trending/7566643604752436799/" target="_blank" class="news-link">小米为何自建家电工厂</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="word-group">
                    <div class="word-header">
                        <div class="word-info">
                            <div class="word-name">区块链 比特币 以太坊 狗狗币 shib 马斯克</div>
                            <div class="word-count ">1 条</div>
                        </div>
                        <div class="word-index">5/5</div>
                    </div>
                    <div class="news-item ">
                        <div class="news-number">1</div>
                        <div class="news-content">
                            <div class="news-header">
                                <span class="source-name">华尔街见闻</span><span class="rank-num ">8-10</span><span class="time-info">09时26分~15时18分</span><span class="count-info">6次</span>
                            </div>
                            <div class="news-title"><a href="https://wallstreetcn.com/articles/3758225" target="_blank" class="news-link">鲍威尔发布会称12月降息并非必然，美股、美债、黄金、比特币盘中跳水，美元涨</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="footer">
                <div class="footer-content">
                    由 <span class="project-name">TrendRadar</span> 生成 · 
                    <a href="https://github.com/sansan0/TrendRadar" target="_blank" class="footer-link">
                        GitHub 开源项目
                    </a>
                </div>
            </div>
        </div>
        
        <script>
            async function saveAsImage() {
                const button = event.target;
                const originalText = button.textContent;
                
                try {
                    button.textContent = '生成中...';
                    button.disabled = true;
                    window.scrollTo(0, 0);
                    
                    // 等待页面稳定
                    await new Promise(resolve => setTimeout(resolve, 200));
                    
                    // 截图前隐藏按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 再次等待确保按钮完全隐藏
                    await new Promise(resolve => setTimeout(resolve, 100));
                    
                    const container = document.querySelector('.container');
                    
                    const canvas = await html2canvas(container, {
                        backgroundColor: '#ffffff',
                        scale: 1.5,
                        useCORS: true,
                        allowTaint: false,
                        imageTimeout: 10000,
                        removeContainer: false,
                        foreignObjectRendering: false,
                        logging: false,
                        width: container.offsetWidth,
                        height: container.offsetHeight,
                        x: 0,
                        y: 0,
                        scrollX: 0,
                        scrollY: 0,
                        windowWidth: window.innerWidth,
                        windowHeight: window.innerHeight
                    });
                    
                    buttons.style.visibility = 'visible';
                    
                    const link = document.createElement('a');
                    const now = new Date();
                    const filename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}.png`;
                    
                    link.download = filename;
                    link.href = canvas.toDataURL('image/png', 1.0);
                    
                    // 触发下载
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    
                    button.textContent = '保存成功!';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            async function saveAsMultipleImages() {
                const button = event.target;
                const originalText = button.textContent;
                const container = document.querySelector('.container');
                const scale = 1.5; 
                const maxHeight = 5000 / scale;
                
                try {
                    button.textContent = '分析中...';
                    button.disabled = true;
                    
                    // 获取所有可能的分割元素
                    const newsItems = Array.from(container.querySelectorAll('.news-item'));
                    const wordGroups = Array.from(container.querySelectorAll('.word-group'));
                    const newSection = container.querySelector('.new-section');
                    const errorSection = container.querySelector('.error-section');
                    const header = container.querySelector('.header');
                    const footer = container.querySelector('.footer');
                    
                    // 计算元素位置和高度
                    const containerRect = container.getBoundingClientRect();
                    const elements = [];
                    
                    // 添加header作为必须包含的元素
                    elements.push({
                        type: 'header',
                        element: header,
                        top: 0,
                        bottom: header.offsetHeight,
                        height: header.offsetHeight
                    });
                    
                    // 添加错误信息（如果存在）
                    if (errorSection) {
                        const rect = errorSection.getBoundingClientRect();
                        elements.push({
                            type: 'error',
                            element: errorSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 按word-group分组处理news-item
                    wordGroups.forEach(group => {
                        const groupRect = group.getBoundingClientRect();
                        const groupNewsItems = group.querySelectorAll('.news-item');
                        
                        // 添加word-group的header部分
                        const wordHeader = group.querySelector('.word-header');
                        if (wordHeader) {
                            const headerRect = wordHeader.getBoundingClientRect();
                            elements.push({
                                type: 'word-header',
                                element: wordHeader,
                                parent: group,
                                top: groupRect.top - containerRect.top,
                                bottom: headerRect.bottom - containerRect.top,
                                height: headerRect.height
                            });
                        }
                        
                        // 添加每个news-item
                        groupNewsItems.forEach(item => {
                            const rect = item.getBoundingClientRect();
                            elements.push({
                                type: 'news-item',
                                element: item,
                                parent: group,
                                top: rect.top - containerRect.top,
                                bottom: rect.bottom - containerRect.top,
                                height: rect.height
                            });
                        });
                    });
                    
                    // 添加新增新闻部分
                    if (newSection) {
                        const rect = newSection.getBoundingClientRect();
                        elements.push({
                            type: 'new-section',
                            element: newSection,
                            top: rect.top - containerRect.top,
                            bottom: rect.bottom - containerRect.top,
                            height: rect.height
                        });
                    }
                    
                    // 添加footer
                    const footerRect = footer.getBoundingClientRect();
                    elements.push({
                        type: 'footer',
                        element: footer,
                        top: footerRect.top - containerRect.top,
                        bottom: footerRect.bottom - containerRect.top,
                        height: footer.offsetHeight
                    });
                    
                    // 计算分割点
                    const segments = [];
                    let currentSegment = { start: 0, end: 0, height: 0, includeHeader: true };
                    let headerHeight = header.offsetHeight;
                    currentSegment.height = headerHeight;
                    
                    for (let i = 1; i < elements.length; i++) {
                        const element = elements[i];
                        const potentialHeight = element.bottom - currentSegment.start;
                        
                        // 检查是否需要创建新分段
                        if (potentialHeight > maxHeight && currentSegment.height > headerHeight) {
                            // 在前一个元素结束处分割
                            currentSegment.end = elements[i - 1].bottom;
                            segments.push(currentSegment);
                            
                            // 开始新分段
                            currentSegment = {
                                start: currentSegment.end,
                                end: 0,
                                height: element.bottom - currentSegment.end,
                                includeHeader: false
                            };
                        } else {
                            currentSegment.height = potentialHeight;
                            currentSegment.end = element.bottom;
                        }
                    }
                    
                    // 添加最后一个分段
                    if (currentSegment.height > 0) {
                        currentSegment.end = container.offsetHeight;
                        segments.push(currentSegment);
                    }
                    
                    button.textContent = `生成中 (0/${segments.length})...`;
                    
                    // 隐藏保存按钮
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'hidden';
                    
                    // 为每个分段生成图片
                    const images = [];
                    for (let i = 0; i < segments.length; i++) {
                        const segment = segments[i];
                        button.textContent = `生成中 (${i + 1}/${segments.length})...`;
                        
                        // 创建临时容器用于截图
                        const tempContainer = document.createElement('div');
                        tempContainer.style.cssText = `
                            position: absolute;
                            left: -9999px;
                            top: 0;
                            width: ${container.offsetWidth}px;
                            background: white;
                        `;
                        tempContainer.className = 'container';
                        
                        // 克隆容器内容
                        const clonedContainer = container.cloneNode(true);
                        
                        // 移除克隆内容中的保存按钮
                        const clonedButtons = clonedContainer.querySelector('.save-buttons');
                        if (clonedButtons) {
                            clonedButtons.style.display = 'none';
                        }
                        
                        tempContainer.appendChild(clonedContainer);
                        document.body.appendChild(tempContainer);
                        
                        // 等待DOM更新
                        await new Promise(resolve => setTimeout(resolve, 100));
                        
                        // 使用html2canvas截取特定区域
                        const canvas = await html2canvas(clonedContainer, {
                            backgroundColor: '#ffffff',
                            scale: scale,
                            useCORS: true,
                            allowTaint: false,
                            imageTimeout: 10000,
                            logging: false,
                            width: container.offsetWidth,
                            height: segment.end - segment.start,
                            x: 0,
                            y: segment.start,
                            windowWidth: window.innerWidth,
                            windowHeight: window.innerHeight
                        });
                        
                        images.push(canvas.toDataURL('image/png', 1.0));
                        
                        // 清理临时容器
                        document.body.removeChild(tempContainer);
                    }
                    
                    // 恢复按钮显示
                    buttons.style.visibility = 'visible';
                    
                    // 下载所有图片
                    const now = new Date();
                    const baseFilename = `TrendRadar_热点新闻分析_${now.getFullYear()}${String(now.getMonth() + 1).padStart(2, '0')}${String(now.getDate()).padStart(2, '0')}_${String(now.getHours()).padStart(2, '0')}${String(now.getMinutes()).padStart(2, '0')}`;
                    
                    for (let i = 0; i < images.length; i++) {
                        const link = document.createElement('a');
                        link.download = `${baseFilename}_part${i + 1}.png`;
                        link.href = images[i];
                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);
                        
                        // 延迟一下避免浏览器阻止多个下载
                        await new Promise(resolve => setTimeout(resolve, 100));
                    }
                    
                    button.textContent = `已保存 ${segments.length} 张图片!`;
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                    
                } catch (error) {
                    console.error('分段保存失败:', error);
                    const buttons = document.querySelector('.save-buttons');
                    buttons.style.visibility = 'visible';
                    button.textContent = '保存失败';
                    setTimeout(() => {
                        button.textContent = originalText;
                        button.disabled = false;
                    }, 2000);
                }
            }
            
            document.addEventListener('DOMContentLoaded', function() {
                window.scrollTo(0, 0);
            });
        </script>
    </body>
    </html>
    